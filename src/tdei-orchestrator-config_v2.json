{
    "workflows": [
        {
            "name": "osw_upload",
            "description": "Workflow for uploading osw files",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "tdei_project_group_id": "<%=tdei_project_group_id%>",
                "dataset_url": "<%=dataset_url%>",
                "metadata_url": "<%=metadata_url%>",
                "changeset_url": "<%=changeset_url%>",
                "latest_dataset_url": "<%=latest_dataset_url%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>"
            },
            "tasks": [
                {
                    "name": "osw_validation",
                    "task_reference_name": "osw_validation",
                    "description": "Validating the uploaded osw file",
                    "type": "Event",
                    "topic": "osw-validation-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "tdei_project_group_id": "<%=workflow_input.tdei_project_group_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "osw_osm_formatting",
                    "task_reference_name": "osw_osm_formatting",
                    "description": "Formating the validated osw file",
                    "type": "Event",
                    "topic": "osw-formatting-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "tdei_project_group_id": "<%=workflow_input.tdei_project_group_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "formatted_url": "<%=data.formatted_url%>"
                    }
                },
                {
                    "name": "update_formatted_url_db",
                    "task_reference_name": "update_formatted_url_db",
                    "description": "Updating the dataset osw url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "osm_url": "<%= decodeURIComponent(tasks.osw_osm_formatting.output.formatted_url) %>",
                            "latest_osm_url": "<%= decodeURIComponent(tasks.osw_osm_formatting.output.formatted_url) %>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "get_blob_folder_path_wo_ext",
                    "task_reference_name": "get_blob_folder_path_wo_ext",
                    "description": "Getting the blob folder path for zip upload",
                    "type": "Utility",
                    "input_params": {
                        "blobUrl": "<%=workflow_input.dataset_url%>",
                        "identifier": "<%=workflow_input.tdei_dataset_id%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>",
                        "folder_path": "<%=folder_path%>"
                    },
                    "function": "get_blob_folder_path_wo_ext"
                },
                {
                    "name": "osm_compression",
                    "task_reference_name": "osm_compression",
                    "description": "Compressing the osm, metadata and changeset files",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "isOsm": true,
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osw_osm_formatting.output.formatted_url), workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=tasks.get_blob_folder_path_wo_ext.output.folder_path%>.osm.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "update_osm_db",
                    "task_reference_name": "update_osm_db",
                    "description": "Updating the dataset osm download url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "dataset_osm_download_url": "<%=tasks.osm_compression.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osw_compression",
                    "task_reference_name": "osw_compression",
                    "description": "Compressing the osw, metadata and changeset files",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "isOsm": false,
                        "input_urls": "<%= JSON.stringify([workflow_input.latest_dataset_url, workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=tasks.get_blob_folder_path_wo_ext.output.folder_path%>.osw.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "update_osw_db",
                    "task_reference_name": "update_osw_db",
                    "description": "Updating the dataset download url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "dataset_download_url": "<%=tasks.osw_compression.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osw_extract_load",
                    "task_reference_name": "osw_extract_load",
                    "description": "Unpacking the osw dataset elements to the database",
                    "type": "Event",
                    "topic": "extract-load-request",
                    "input_params": {
                        "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>",
                        "data_type": "osw"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "osw_pre_release_db",
                    "task_reference_name": "osw_pre_release_db",
                    "description": "Updating the status of the dataset to Pre-Release",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "status": "Pre-Release"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osm_upload_job_update_db",
                    "task_reference_name": "osm_upload_job_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "osw_upload_failure",
                    "task_reference_name": "osw_upload_failure",
                    "description": "Deleting the draft dataset on failure",
                    "type": "Exception",
                    "input_params": {
                        "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "delete_draft_dataset"
                },
                {
                    "name": "osw_upload_failure_db",
                    "task_reference_name": "osw_upload_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_publish",
            "description": "Workflow for publishing osw files",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>",
                "dataset_url": "<%=dataset_url%>",
                "metadata_url": "<%=metadata_url%>"
            },
            "tasks": [
                {
                    "name": "osw_confidence",
                    "task_reference_name": "osw_confidence",
                    "description": "Calculating the confidence metric score of the dataset",
                    "type": "Event",
                    "topic": "osw-confidence-request",
                    "input_params": {
                        "jobId": "<%=JSON.stringify(workflow_input.job_id)%>",
                        "data_file": "<%=workflow_input.dataset_url%>",
                        "meta_file": "<%=workflow_input.metadata_url%>",
                        "trigger_type": "release"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "confidence_scores": "<%= JSON.stringify(data.confidence_scores)%>",
                        "confidence_library_version": "<%=data.confidence_library_version%>"
                    }
                },
                {
                    "name": "update_confidence_db",
                    "task_reference_name": "update_confidence_db",
                    "description": "Updating the confidence score of the dataset",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "confidence_level": "<%=tasks.osw_confidence.output.confidence_scores.features[0].properties.confidence_score%>",
                            "cm_version": "<%=tasks.osw_confidence.output.confidence_library_version%>",
                            "cm_last_calculated_at": "CURRENT_TIMESTAMP",
                            "updated_at": "CURRENT_TIMESTAMP"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osw_publish_db",
                    "task_reference_name": "osw_publish_db",
                    "description": "Updating the status of the dataset to Published",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "status": "Publish"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osm_publish_job_update_db",
                    "task_reference_name": "osm_publish_job_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_validation_only",
            "description": "Workflow for validating osw files",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "dataset_url": "<%=dataset_url%>"
            },
            "tasks": [
                {
                    "name": "osw_validation_only",
                    "task_reference_name": "osw_validation_only",
                    "description": "Validating the uploaded osw file",
                    "type": "Event",
                    "topic": "osw-validation-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "osw_validation_only_update_db",
                    "task_reference_name": "osw_validation_only_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "build_osw_osm_dataset_download",
            "description": "Clone the dataset",
            "workflow_input": {
                "user_id": "<%=user_id%>",
                "job_id": "<%=job_id%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>",
                "dataset_osm_url": "<%=dataset_osm_url%>",
                "dataset_url": "<%=dataset_url%>",
                "metadata_url": "<%=metadata_url%>",
                "changeset_url": "<%=changeset_url%>"
            },
            "tasks": [
                {
                    "name": "get_blob_folder_path_wo_ext",
                    "task_reference_name": "get_blob_folder_path_wo_ext",
                    "description": "Getting the blob folder path for zip upload",
                    "type": "Utility",
                    "input_params": {
                        "blobUrl": "<%=workflow_input.dataset_url%>",
                        "identifier": "<%=workflow_input.tdei_dataset_id%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>",
                        "folder_path": "<%=folder_path%>"
                    },
                    "function": "get_blob_folder_path_wo_ext"
                },
                {
                    "name": "osw_compression",
                    "task_reference_name": "osw_compression",
                    "description": "Compressing the osw, metadata and changeset files",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "isOsm": false,
                        "input_urls": "<%= JSON.stringify([workflow_input.dataset_url, workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=tasks.get_blob_folder_path_wo_ext.output.folder_path%>.osw.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "update_osw_db",
                    "task_reference_name": "update_osw_db",
                    "description": "Updating the dataset download url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "dataset_download_url": "<%=tasks.osw_compression.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osm_compression",
                    "task_reference_name": "osm_compression",
                    "description": "Compressing the osw, metadata and changeset files",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "isOsm": true,
                        "input_urls": "<%= JSON.stringify([workflow_input.dataset_osm_url, workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=tasks.get_blob_folder_path_wo_ext.output.folder_path%>.osm.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "update_osm_db",
                    "task_reference_name": "update_osm_db",
                    "description": "Updating the dataset download url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "dataset_osm_download_url": "<%=tasks.osm_compression.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "job_update_db",
                    "task_reference_name": "job_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "build_dataset_download",
            "description": "Clone the dataset (flex, Pathways)",
            "workflow_input": {
                "user_id": "<%=user_id%>",
                "job_id": "<%=job_id%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>",
                "dataset_url": "<%=dataset_url%>",
                "metadata_url": "<%=metadata_url%>",
                "changeset_url": "<%=changeset_url%>"
            },
            "tasks": [
                {
                    "name": "get_blob_folder_path_wo_ext",
                    "task_reference_name": "get_blob_folder_path_wo_ext",
                    "description": "Getting the blob folder path for zip upload",
                    "type": "Utility",
                    "input_params": {
                        "blobUrl": "<%=workflow_input.dataset_url%>",
                        "identifier": "<%=workflow_input.tdei_dataset_id%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>",
                        "folder_path": "<%=folder_path%>"
                    },
                    "function": "get_blob_folder_path_wo_ext"
                },
                {
                    "name": "osw_compression",
                    "task_reference_name": "osw_compression",
                    "description": "Compressing the osw, metadata and changeset files",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "isOsm": false,
                        "input_urls": "<%= JSON.stringify([workflow_input.dataset_url, workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=tasks.get_blob_folder_path_wo_ext.output.folder_path%>.osw.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "update_osw_db",
                    "task_reference_name": "update_osw_db",
                    "description": "Updating the dataset download url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "dataset_download_url": "<%=tasks.osw_compression.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "job_update_db",
                    "task_reference_name": "job_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_formatting_on_demand",
            "description": "Convert the osw/osm file",
            "workflow_input": {
                "user_id": "<%=user_id%>",
                "job_id": "<%=job_id%>",
                "source": "<%=source%>",
                "target": "<%=target%>",
                "sourceUrl": "<%=sourceUrl%>"
            },
            "tasks": [
                {
                    "name": "osw_osm_formatting_ON_DEMAND",
                    "task_reference_name": "osw_osm_formatting_ON_DEMAND",
                    "description": "Converting the osw/osm file",
                    "type": "Event",
                    "topic": "osw-formatting-request",
                    "input_params": {
                        "jobId": "<%=workflow_input.job_id%>",
                        "source": "<%=workflow_input.source%>",
                        "target": "<%=workflow_input.target%>",
                        "sourceUrl": "<%=workflow_input.sourceUrl%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "formattedUrl": "<%=data.formattedUrl%>"
                    }
                },
                {
                    "name": "osw_formatting_on_demand_compression",
                    "task_reference_name": "osw_formatting_on_demand_compression",
                    "description": "Compressing the converted file",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osw_osm_formatting_ON_DEMAND.output.formattedUrl)]) %>",
                        "output_path": "<%=decodeURIComponent(tasks.osw_osm_formatting_ON_DEMAND.output.formattedUrl)%>.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "job_update_db",
                    "task_reference_name": "job_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "download_url": "<%= tasks.osw_formatting_on_demand_compression.output.output_path %>",
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_confidence_on_demand",
            "description": "Calculate the confidence score of the dataset",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "dataset_url": "<%=dataset_url%>",
                "metadata_url": "<%=metadata_url%>",
                "sub_regions_file": "<%=sub_regions_file%>"
            },
            "tasks": [
                {
                    "name": "osw_confidence_on_demand",
                    "task_reference_name": "osw_confidence_on_demand",
                    "description": "Calculating the confidence metric score of the dataset",
                    "type": "Event",
                    "topic": "osw-confidence-request",
                    "input_params": {
                        "jobId": "<%=JSON.stringify(workflow_input.job_id)%>",
                        "data_file": "<%=workflow_input.dataset_url%>",
                        "meta_file": "<%=workflow_input.metadata_url%>",
                        "sub_regions_file": "<%=workflow_input.sub_regions_file%>",
                        "trigger_type": "manual"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "confidence_scores": "<%= JSON.stringify(data.confidence_scores)%>",
                        "confidence_library_version": "<%=data.confidence_library_version%>"
                    }
                },
                {
                    "name": "update_confidence_db_on_demand",
                    "task_reference_name": "update_confidence_db_on_demand",
                    "description": "Updating the confidence metric score to the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "response_props": {
                                "confidence_scores": "<%=JSON.stringify(tasks.osw_confidence_on_demand.output.confidence_scores)%>",
                                "confidence_library_version": "<%=tasks.osw_confidence_on_demand.output.confidence_library_version%>"
                            },
                            "updated_at": "CURRENT_TIMESTAMP",
                            "status": "COMPLETED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_dataset_road_tag",
            "description": "Update the sidewalks with road tags for the dataset",
            "workflow_input": {
                "service": "<%=service %>",
                "user_id": "<%=user_id%>",
                "parameters": "<%= JSON.stringify(parameters) %>",
                "tdei_project_group_id": "<%=tdei_project_group_id%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>",
                "metadata_url": "<%=metadata_url%>",
                "changeset_url": "<%=changeset_url%>",
                "job_id": "<%=job_id%>",
                "dataset_url": "<%=dataset_url%>"
            },
            "tasks": [
                {
                    "name": "osw_dataset_road_tag",
                    "task_reference_name": "osw_dataset_road_tag",
                    "description": "Updating the sidewalks with road tags for the dataset",
                    "type": "Event",
                    "topic": "backend-request",
                    "input_params": {
                        "service": "<%=workflow_input.service%>",
                        "user_id": "<%=workflow_input.user_id%>",
                        "parameters": "<%= JSON.stringify(workflow_input.parameters) %>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "file_upload_path": "<%=data.file_upload_path%>"
                    }
                },
                {
                    "name": "update_osw_road_tag_url_db",
                    "task_reference_name": "update_osw_road_tag_url_db",
                    "description": "Updating the updated osw dataset url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "latest_dataset_url": "<%=decodeURIComponent(tasks.osw_dataset_road_tag.output.file_upload_path)%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osw_road_tag_osm_formatting",
                    "task_reference_name": "osw_road_tag_osm_formatting",
                    "description": "Formating the updated dataset to osm",
                    "type": "Event",
                    "topic": "osw-formatting-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "tdei_project_group_id": "<%=workflow_input.tdei_project_group_id%>",
                        "file_upload_path": "<%=decodeURIComponent(tasks.osw_dataset_road_tag.output.file_upload_path)%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "formatted_url": "<%=data.formatted_url%>"
                    }
                },
                {
                    "name": "update_osm_db_road_tag",
                    "task_reference_name": "update_osm_db_road_tag",
                    "description": "Updating the dataset osm file url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "latest_osm_url": "<%=decodeURIComponent(tasks.osw_road_tag_osm_formatting.output.formatted_url)%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "get_blob_folder_path_wo_ext",
                    "task_reference_name": "get_blob_folder_path_wo_ext",
                    "description": "Getting the blob folder path for zip upload",
                    "type": "Utility",
                    "input_params": {
                        "blobUrl": "<%=workflow_input.dataset_url%>",
                        "identifier": "<%=workflow_input.tdei_dataset_id%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>",
                        "folder_path": "<%=folder_path%>"
                    },
                    "function": "get_blob_folder_path_wo_ext"
                },
                {
                    "name": "osm_compression_road_tag",
                    "task_reference_name": "osm_compression_road_tag",
                    "description": "Compressing the osm file",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osw_road_tag_osm_formatting.output.formatted_url), workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=decodeURIComponent(tasks.get_blob_folder_path_wo_ext.output.folder_path)%>.osm.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "update_osm_download_url_db_road_tag",
                    "task_reference_name": "update_osm_download_url_db_road_tag",
                    "description": "Updating the dataset osm dataset download url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "dataset_osm_download_url": "<%=tasks.osm_compression_road_tag.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osw_compression_road_tag",
                    "task_reference_name": "osw_compression_road_tag",
                    "description": "Compressing the osw dataset",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osw_dataset_road_tag.output.file_upload_path), workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=decodeURIComponent(tasks.get_blob_folder_path_wo_ext.output.folder_path)%>.osw.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "update_osw_db_road_tag",
                    "task_reference_name": "update_osw_db_road_tag",
                    "description": "Updating the dataset download url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "dataset_download_url": "<%=tasks.osw_compression_road_tag.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "update_osw_db_road_tag_job",
                    "task_reference_name": "update_osw_db_road_tag_job",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "download_url": "<%=decodeURIComponent(tasks.osw_compression_road_tag.output.output_path)%>",
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osm_dataset_bbox",
            "description": "Gets the osw dataset elements within the bbox",
            "workflow_input": {
                "service": "<%=service %>",
                "user_id": "<%=user_id%>",
                "parameters": "<%= JSON.stringify(parameters) %>",
                "tdei_project_group_id": "<%=tdei_project_group_id%>",
                "job_id": "<%=job_id%>"
            },
            "tasks": [
                {
                    "name": "osm_dataset_bbox",
                    "task_reference_name": "osm_dataset_bbox",
                    "description": "Geting the osw dataset elements within the bbox",
                    "type": "Event",
                    "topic": "backend-request",
                    "input_params": {
                        "service": "<%=workflow_input.service%>",
                        "user_id": "<%=workflow_input.user_id%>",
                        "parameters": "<%= JSON.stringify(workflow_input.parameters) %>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "file_upload_path": "<%=data.file_upload_path%>"
                    }
                },
                {
                    "name": "osm_bbox_response_validation",
                    "task_reference_name": "osm_bbox_response_validation",
                    "description": "Validating the bbox response",
                    "type": "Utility",
                    "input_params": {
                        "job_id": "<%=workflow_input.job_id%>",
                        "success": "<%=tasks.osm_dataset_bbox.output.success%>",
                        "message": "<%=tasks.osm_dataset_bbox.output.message%>",
                        "file_upload_path": "<%=tasks.osm_dataset_bbox.output.file_upload_path%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "bbox_response_validation"
                },
                {
                    "name": "osm_dataset_bbox_osm_formatting",
                    "task_reference_name": "osm_dataset_bbox_osm_formatting",
                    "description": "Converting the osw dataset to osm",
                    "type": "Event",
                    "topic": "osw-formatting-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "tdei_project_group_id": "<%=workflow_input.tdei_project_group_id%>",
                        "file_upload_path": "<%=tasks.osm_dataset_bbox.output.file_upload_path%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "formatted_url": "<%=data.formatted_url%>"
                    }
                },
                {
                    "name": "osm_compression_bbox",
                    "task_reference_name": "osm_compression_bbox",
                    "description": "Compressing the osm file",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osm_dataset_bbox_osm_formatting.output.formatted_url)]) %>",
                        "output_path": "<%=decodeURIComponent(tasks.osm_dataset_bbox_osm_formatting.output.formatted_url)%>.osm.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "osm_bbox_job_db",
                    "task_reference_name": "osm_bbox_job_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "download_url": "<%=decodeURIComponent(tasks.osm_compression_bbox.output.output_path)%>",
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_dataset_bbox",
            "description": "Gets the osw dataset elements within the bbox",
            "workflow_input": {
                "service": "<%=service %>",
                "user_id": "<%=user_id%>",
                "parameters": "<%= JSON.stringify(parameters) %>",
                "job_id": "<%=job_id%>"
            },
            "tasks": [
                {
                    "name": "osw_dataset_bbox",
                    "task_reference_name": "osw_dataset_bbox",
                    "description": "Geting the osw dataset elements within the bbox",
                    "type": "Event",
                    "topic": "backend-request",
                    "input_params": {
                        "service": "<%=workflow_input.service%>",
                        "user_id": "<%=workflow_input.user_id%>",
                        "parameters": "<%= JSON.stringify(workflow_input.parameters) %>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "file_upload_path": "<%=data.file_upload_path%>"
                    }
                },
                {
                    "name": "osw_bbox_response_validation",
                    "task_reference_name": "osw_bbox_response_validation",
                    "description": "Validating the bbox response",
                    "type": "Utility",
                    "input_params": {
                        "job_id": "<%=workflow_input.job_id%>",
                        "success": "<%=tasks.osw_dataset_bbox.output.success%>",
                        "message": "<%=tasks.osw_dataset_bbox.output.message%>",
                        "file_upload_path": "<%=tasks.osw_dataset_bbox.output.file_upload_path%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "bbox_response_validation"
                },
                {
                    "name": "osw_compression_bbox",
                    "task_reference_name": "osw_compression_bbox",
                    "description": "Compressing the osw file",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osw_dataset_bbox.output.file_upload_path)]) %>",
                        "output_path": "<%=decodeURIComponent(tasks.osw_dataset_bbox.output.file_upload_path)%>.osw.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "osm_bbox_job_db",
                    "task_reference_name": "osm_bbox_job_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "download_url": "<%=decodeURIComponent(tasks.osw_compression_bbox.output.output_path)%>",
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_spatial_join",
            "description": "Performs spatial join on the osw dataset",
            "workflow_input": {
                "service": "<%=service %>",
                "user_id": "<%=user_id%>",
                "parameters": "<%= JSON.stringify(parameters) %>",
                "job_id": "<%=job_id%>"
            },
            "tasks": [
                {
                    "name": "osw_spatial_join",
                    "task_reference_name": "osw_spatial_join",
                    "description": "Performing the spatial join on the osw dataset",
                    "type": "Event",
                    "topic": "backend-request",
                    "input_params": {
                        "service": "<%=workflow_input.service%>",
                        "user_id": "<%=workflow_input.user_id%>",
                        "parameters": "<%= JSON.stringify(workflow_input.parameters) %>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "file_upload_path": "<%=data.file_upload_path%>"
                    }
                },
                {
                    "name": "osw_compression",
                    "task_reference_name": "osw_compression",
                    "description": "Compressing the osw file",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osw_spatial_join.output.file_upload_path)]) %>",
                        "output_path": "<%=decodeURIComponent(tasks.osw_spatial_join.output.file_upload_path)%>.osw.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "osm_spatial_join_job_db",
                    "task_reference_name": "osm_spatial_join_job_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "download_url": "<%=decodeURIComponent(tasks.osw_compression.output.output_path)%>",
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "flex_upload",
            "description": "Workflow for uploading flex files",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "tdei_project_group_id": "<%=tdei_project_group_id%>",
                "dataset_url": "<%=dataset_url%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>",
                "metadata_url": "<%=metadata_url%>",
                "changeset_url": "<%=changeset_url%>"
            },
            "tasks": [
                {
                    "name": "flex_upload_validation",
                    "task_reference_name": "flex_upload_validation",
                    "description": "Validating the uploaded flex dataset",
                    "type": "Event",
                    "topic": "flex-validation-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "tdei_project_group_id": "<%=workflow_input.tdei_project_group_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "get_blob_folder_path_wo_ext",
                    "task_reference_name": "get_blob_folder_path_wo_ext",
                    "description": "Getting the blob folder path for zip upload",
                    "type": "Utility",
                    "input_params": {
                        "blobUrl": "<%=workflow_input.dataset_url%>",
                        "identifier": "<%=workflow_input.tdei_dataset_id%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>",
                        "folder_path": "<%=folder_path%>"
                    },
                    "function": "get_blob_folder_path_wo_ext"
                },
                {
                    "name": "flex_upload_compression",
                    "task_reference_name": "flex_upload_compression",
                    "description": "Compressing the uploaded osw dataset",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "isOsm": true,
                        "input_urls": "<%= JSON.stringify([workflow_input.dataset_url, workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=tasks.get_blob_folder_path_wo_ext.output.folder_path%>.flex.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "flex_upload_update_db",
                    "task_reference_name": "flex_upload_update_db",
                    "description": "Updating the status of the dataset to Pre-Release",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "status": "Pre-Release",
                            "dataset_download_url": "<%=tasks.flex_upload_compression.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "flex_upload_job_update_db",
                    "task_reference_name": "flex_upload_job_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "flex_publish",
            "description": "Workflow for publishing flex files",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>",
                "tdei_project_group_id": "<%=tdei_project_group_id%>",
                "dataset_url": "<%=dataset_url%>"
            },
            "tasks": [
                {
                    "name": "flex_publish_validation",
                    "task_reference_name": "flex_publish_validation",
                    "description": "Validating the flex dataset",
                    "type": "Event",
                    "topic": "flex-validation-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "tdei_project_group_id": "<%=workflow_input.tdei_project_group_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "flex_publish_db",
                    "task_reference_name": "flex_publish_db",
                    "description": "Updating the status of the dataset to Publish",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "status": "Publish"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "flex_publish_job_update_db",
                    "task_reference_name": "flex_publish_job_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "flex_validation_only",
            "description": "Workflow for validating flex files",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "dataset_url": "<%=dataset_url%>"
            },
            "tasks": [
                {
                    "name": "flex_validation_only",
                    "task_reference_name": "flex_validation_only",
                    "description": "Validating the uploaded flex dataset",
                    "type": "Event",
                    "topic": "flex-validation-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "flex_validation_only_update_db",
                    "task_reference_name": "flex_validation_only_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "pathways_upload",
            "description": "Workflow for uploading pathways files",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "tdei_project_group_id": "<%=tdei_project_group_id%>",
                "dataset_url": "<%=dataset_url%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>"
            },
            "tasks": [
                {
                    "name": "pathways_upload_validation",
                    "task_reference_name": "pathways_upload_validation",
                    "description": "Validating the uploaded pathways dataset",
                    "type": "Event",
                    "topic": "pathways-validation-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "tdei_project_group_id": "<%=workflow_input.tdei_project_group_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "get_blob_folder_path_wo_ext",
                    "task_reference_name": "get_blob_folder_path_wo_ext",
                    "description": "Getting the blob folder path for zip upload",
                    "type": "Utility",
                    "input_params": {
                        "blobUrl": "<%=workflow_input.dataset_url%>",
                        "identifier": "<%=workflow_input.tdei_dataset_id%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>",
                        "folder_path": "<%=folder_path%>"
                    },
                    "function": "get_blob_folder_path_wo_ext"
                },
                {
                    "name": "pathways_upload_compression",
                    "task_reference_name": "pathways_upload_compression",
                    "description": "Compressing the uploaded pathways dataset",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "isOsm": true,
                        "input_urls": "<%= JSON.stringify([workflow_input.dataset_url, workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=tasks.get_blob_folder_path_wo_ext.output.folder_path%>.pathways.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "pathways_upload_update_db",
                    "task_reference_name": "pathways_upload_update_db",
                    "description": "Updating the status of the dataset to Pre-Release",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "status": "Pre-Release",
                            "dataset_download_url": "<%=tasks.pathways_upload_compression.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "pathways_upload_job_update_db",
                    "task_reference_name": "pathways_upload_job_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "pathways_publish",
            "description": "Workflow for publishing pathways files",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>",
                "tdei_project_group_id": "<%=tdei_project_group_id%>",
                "dataset_url": "<%=dataset_url%>"
            },
            "tasks": [
                {
                    "name": "pathways_publish_validation",
                    "task_reference_name": "pathways_publish_validation",
                    "description": "Validating the pathways dataset",
                    "type": "Event",
                    "topic": "pathways-validation-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "tdei_project_group_id": "<%=workflow_input.tdei_project_group_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "pathways_publish_db",
                    "task_reference_name": "pathways_publish_db",
                    "description": "Updating the status of the dataset to Publish",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "status": "Publish"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "pathways_publish_job_update_db",
                    "task_reference_name": "pathways_publish_job_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "pathways_validation_only",
            "description": "Workflow for validating pathways files",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "dataset_url": "<%=dataset_url%>"
            },
            "tasks": [
                {
                    "name": "pathways_validation_only",
                    "task_reference_name": "pathways_validation_only",
                    "description": "Validating the uploaded pathways dataset",
                    "type": "Event",
                    "topic": "pathways-validation-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "file_upload_path": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "pathways_validation_only_update_db",
                    "task_reference_name": "pathways_validation_only_update_db",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_quality_metric_on_demand",
            "description": "Calculate the quality metric of dataset and persist optionally",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "file_url": "<%=file_url%>",
                "algorithm": "<%=algorithm%>",
                "sub_regions_file": "<%=sub_regions_file%>"
            },
            "tasks": [
                {
                    "name": "osw_quality_metric_on_demand",
                    "task_reference_name": "osw_quality_metric_on_demand",
                    "description": "Calculating the Quality metric score of the dataset",
                    "type": "Event",
                    "topic": "osw-quality-request",
                    "input_params": {
                        "jobId": "<%=JSON.stringify(workflow_input.job_id)%>",
                        "data_file": "<%=workflow_input.file_url%>",
                        "algorithm": "<%=workflow_input.algorithm%>",
                        "sub_regions_file": "<%=workflow_input.sub_regions_file%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "dataset_url": "<%= data.dataset_url %>",
                        "qm_dataset_url": "<%=data.qm_dataset_url%>"
                    }
                },
                {
                    "name": "update_quality_metric_job_db",
                    "task_reference_name": "update_quality_metric_job_db",
                    "description": "Updating the quality metric score to the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "response_props": {
                                "dataset_url": "<%=tasks.osw_quality_metric_on_demand.output.dataset_url%>",
                                "qm_dataset_url": "<%=tasks.osw_quality_metric_on_demand.output.qm_dataset_url%>"
                            },
                            "download_url": "<%=tasks.osw_quality_metric_on_demand.output.qm_dataset_url%>",
                            "updated_at": "CURRENT_TIMESTAMP",
                            "status": "COMPLETED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_dataset_incline_tag",
            "description": "Update the dataset with incline tags",
            "workflow_input": {
                "job_id": "<%=job_id%>",
                "user_id": "<%=user_id%>",
                "dataset_url": "<%=dataset_url%>",
                "metadata_url": "<%=metadata_url%>",
                "changeset_url": "<%=changeset_url%>",
                "tdei_dataset_id": "<%=tdei_dataset_id%>",
                "tdei_project_group_id": "<%=tdei_project_group_id%>"
            },
            "tasks": [
                {
                    "name": "osw_dataset_incline_tag",
                    "task_reference_name": "osw_dataset_incline_tag",
                    "description": "Updating the dataset with incline tags",
                    "type": "Event",
                    "topic": "osw-incline-request",
                    "input_params": {
                        "jobId": "<%=JSON.stringify(workflow_input.job_id)%>",
                        "user_id": "<%=workflow_input.user_id%>",
                        "dataset_url": "<%=workflow_input.dataset_url%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "file_upload_path": "<%=data.file_upload_path%>"
                    }
                },
                {
                    "name": "update_osw_incline_tag_url_db",
                    "task_reference_name": "update_osw_incline_tag_url_db",
                    "description": "Updating the updated osw dataset url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "latest_dataset_url": "<%=decodeURIComponent(tasks.osw_dataset_incline_tag.output.file_upload_path)%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osw_incline_tag_osm_formatting",
                    "task_reference_name": "osw_incline_tag_osm_formatting",
                    "description": "Formating the updated dataset to osm",
                    "type": "Event",
                    "topic": "osw-formatting-request",
                    "input_params": {
                        "user_id": "<%=workflow_input.user_id%>",
                        "tdei_project_group_id": "<%=workflow_input.tdei_project_group_id%>",
                        "file_upload_path": "<%=decodeURIComponent(tasks.osw_dataset_incline_tag.output.file_upload_path)%>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "formatted_url": "<%=data.formatted_url%>"
                    }
                },
                {
                    "name": "update_osm_db_incline_tag",
                    "task_reference_name": "update_osm_db_incline_tag",
                    "description": "Updating the dataset osm file url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "latest_osm_url": "<%=decodeURIComponent(tasks.osw_incline_tag_osm_formatting.output.formatted_url)%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "get_incline_blob_folder_path_wo_ext",
                    "task_reference_name": "get_incline_blob_folder_path_wo_ext",
                    "description": "Getting the blob folder path for zip upload",
                    "type": "Utility",
                    "input_params": {
                        "blobUrl": "<%=tasks.osw_dataset_incline_tag.output.file_upload_path%>",
                        "identifier": "<%=workflow_input.tdei_dataset_id%>"
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>",
                        "folder_path": "<%=folder_path%>"
                    },
                    "function": "get_blob_folder_path_wo_ext"
                },
                {
                    "name": "osm_compression_incline_tag",
                    "task_reference_name": "osm_compression_incline_tag",
                    "description": "Compressing the osm file",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osw_incline_tag_osm_formatting.output.formatted_url), workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=decodeURIComponent(tasks.get_incline_blob_folder_path_wo_ext.output.folder_path)%>.osm.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "update_osm_download_url_db_incline_tag",
                    "task_reference_name": "update_osm_download_url_db_incline_tag",
                    "description": "Updating the dataset osm dataset download url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "dataset_osm_download_url": "<%=tasks.osm_compression_incline_tag.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osw_compression_incline_tag",
                    "task_reference_name": "osw_compression_incline_tag",
                    "description": "Compressing the osw dataset",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osw_dataset_incline_tag.output.file_upload_path), workflow_input.metadata_url, workflow_input.changeset_url]) %>",
                        "output_path": "<%=decodeURIComponent(tasks.get_incline_blob_folder_path_wo_ext.output.folder_path)%>.osw.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "update_osw_db_incline_tag",
                    "task_reference_name": "update_osw_db_incline_tag",
                    "description": "Updating the dataset download url",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.dataset",
                        "where": {
                            "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>"
                        },
                        "data": {
                            "dataset_download_url": "<%=tasks.osw_compression_incline_tag.output.output_path%>"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                },
                {
                    "name": "osw_extract_load",
                    "task_reference_name": "osw_extract_load",
                    "description": "Unpacking the osw dataset elements to the database",
                    "type": "Event",
                    "topic": "extract-load-request",
                    "input_params": {
                        "tdei_dataset_id": "<%=workflow_input.tdei_dataset_id%>",
                        "file_upload_path": "<%=tasks.osw_compression_incline_tag.output.output_path%>",
                        "data_type": "osw"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>"
                    }
                },
                {
                    "name": "update_osw_db_incline_tag_job",
                    "task_reference_name": "update_osw_db_incline_tag_job",
                    "description": "Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "download_url": "<%=decodeURIComponent(tasks.osw_compression_incline_tag.output.output_path)%>",
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Updating the job details on failure",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        },
        {
            "name": "osw_union_join",
            "description": "Performs union join on the osw dataset",
            "workflow_input": {
                "service": "<%=service %>",
                "user_id": "<%=user_id%>",
                "parameters": "<%= JSON.stringify(parameters) %>",
                "job_id": "<%=job_id%>"
            },
            "tasks": [
                {
                    "name": "osw_union_join",
                    "task_reference_name": "osw_union_join",
                    "description": "Performing the union join on the osw datasets",
                    "type": "Event",
                    "topic": "backend-request",
                    "input_params": {
                        "service": "<%=workflow_input.service%>",
                        "user_id": "<%=workflow_input.user_id%>",
                        "parameters": "<%= JSON.stringify(workflow_input.parameters) %>"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "file_upload_path": "<%=data.file_upload_path%>"
                    }
                },
                {
                    "name": "osw_compression",
                    "task_reference_name": "osw_compression",
                    "description": "Compressing the osw output file",
                    "type": "Event",
                    "topic": "dataset-zip-request",
                    "input_params": {
                        "input_urls": "<%= JSON.stringify([decodeURIComponent(tasks.osw_union_join.output.file_upload_path)]) %>",
                        "output_path": "<%=decodeURIComponent(tasks.osw_union_join.output.file_upload_path)%>.osw.zip"
                    },
                    "output_params": {
                        "success": "<%=data.success%>",
                        "message": "<%=data.message%>",
                        "output_path": "<%=data.output_path%>"
                    }
                },
                {
                    "name": "osm_union_join_job_db",
                    "task_reference_name": "osm_union_join_job_db",
                    "description": "Job success. Updating the job details",
                    "type": "Utility",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "download_url": "<%=decodeURIComponent(tasks.osw_compression.output.output_path)%>",
                            "status": "COMPLETED",
                            "message": "Job Completed Successfully"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ],
            "exception_task": [
                {
                    "name": "job_failure_db",
                    "task_reference_name": "job_failure_db",
                    "description": "Job failed. Updating the job details",
                    "type": "Exception",
                    "input_params": {
                        "table": "content.job",
                        "where": {
                            "job_id": "<%=workflow_input.job_id%>"
                        },
                        "data": {
                            "status": "FAILED"
                        }
                    },
                    "output_params": {
                        "success": "<%=success%>",
                        "message": "<%=message%>"
                    },
                    "function": "update_table"
                }
            ]
        }
    ],
    "subscriptions": [
        {
            "description": "Subscription for osw validation completion",
            "topic": "osw-validation-response",
            "subscription": "res-handler"
        },
        {
            "description": "Subscription for osw formatting completion",
            "topic": "osw-formatting-response",
            "subscription": "res-handler"
        },
        {
            "description": "Subscription for osw confidence completion",
            "topic": "osw-confidence-response",
            "subscription": "res-handler"
        },
        {
            "description": "Subscription for extract load request completion",
            "topic": "extract-load-response",
            "subscription": "res-handler"
        },
        {
            "description": "Subscription for backend service completion",
            "topic": "backend-response",
            "subscription": "res-handler"
        },
        {
            "description": "Subscription for flex validation completion",
            "topic": "flex-validation-response",
            "subscription": "res-handler"
        },
        {
            "description": "Subscription for pathways validation completion",
            "topic": "pathways-validation-response",
            "subscription": "res-handler"
        },
        {
            "description": "Subscription for dataset zipping completion",
            "topic": "dataset-zip-response",
            "subscription": "res-handler"
        },
        {
            "description": "Subscription for osw quality metrics completion",
            "topic": "osw-quality-response",
            "subscription": "res-handler"
        },
        {
            "description": "Subscription for inclination to be added to the dataset",
            "topic": "osw-incline-response",
            "subscription": "res-handler"
        }
    ]
}